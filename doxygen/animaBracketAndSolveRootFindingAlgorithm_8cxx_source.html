<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ANIMA: animaBracketAndSolveRootFindingAlgorithm.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ANIMA
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_83193e57fe923362c47cf9688424d9aa.html">Anima</a></li><li class="navelem"><a class="el" href="dir_f8c9054f2662361191322e2fd31403cb.html">math-tools</a></li><li class="navelem"><a class="el" href="dir_f851f41d247c0702bff777433771a3d2.html">optimizers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">animaBracketAndSolveRootFindingAlgorithm.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="animaBracketAndSolveRootFindingAlgorithm_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="animaBracketAndSolveRootFindingAlgorithm_8h.html">animaBracketAndSolveRootFindingAlgorithm.h</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;boost/math/tools/roots.hpp&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceanima.html">anima</a></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="classanima_1_1BracketAndSolveRootFindingAlgorithm.html#a86f6e705db20a7ffb61530c38abe44f9">    7</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classanima_1_1BracketAndSolveRootFindingAlgorithm.html#a86f6e705db20a7ffb61530c38abe44f9">BracketAndSolveRootFindingAlgorithm::Optimize</a>()</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numParameters = this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#aa673fd745c3d10d230ea6202762c385d">GetRootFindingFunction</a>()-&gt;GetNumberOfParameters();</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="keywordflow">if</span> (numParameters &gt; 1)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <span class="keywordflow">throw</span> itk::ExceptionObject(__FILE__, __LINE__, <span class="stringliteral">&quot;Bracket and solve root algorithm does not implement multi-dimensional optimization. Only one parameter allowed.&quot;</span>);</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    </div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a202d9b7564d73321feeb09ca05d3ab1f">GetProvidedFunctionValueAtInitialLowerBound</a>() &amp;&amp; !this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#ad1cd8c9fbb8b9304e49f237a00f30088">GetProvidedFunctionValueAtInitialUpperBound</a>())</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">throw</span> itk::ExceptionObject(__FILE__, __LINE__, <span class="stringliteral">&quot;You need to provide the function value in at least one of the bounds because the bracket and solve root algorithm needs to know whether the function is rising or falling.&quot;</span>);</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    </div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="classanima_1_1RootFindingFunctionBoostBridge.html">RootFindingFunctionBoostBridge</a> boostFunction;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    boostFunction.<a class="code" href="classanima_1_1RootFindingFunctionBoostBridge.html#aabbc879200ff87c68e34da99ede750bd">SetRootFindingFunction</a>(this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#aa673fd745c3d10d230ea6202762c385d">GetRootFindingFunction</a>());</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    boost::uintmax_t maximumNumberOfIterations = this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a9ce5966e0d71ec6a1b278dc0de18bff9">GetMaximumNumberOfIterations</a>();</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    </div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="classanima_1_1RootToleranceBoostBridge.html">RootToleranceBoostBridge</a> rootTolerance;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    rootTolerance.<a class="code" href="classanima_1_1RootToleranceBoostBridge.html#a3c017a3e2f5570e117f0ecf2d9f99cdb">SetRootRelativeTolerance</a>(this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a31d49752862ff0470e8e91f3d1bbbfb7">GetRootRelativeTolerance</a>());</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">bool</span> risingValue = <span class="keyword">true</span>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a202d9b7564d73321feeb09ca05d3ab1f">GetProvidedFunctionValueAtInitialLowerBound</a>())</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        risingValue = this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a0961ac6d461a4f1b727a9885056b1437">GetFunctionValueAtInitialLowerBound</a>() &lt; 0.0;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        risingValue = this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a707553423a63cf4787b3714475f07c2f">GetFunctionValueAtInitialUpperBound</a>() &gt; 0.0;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    std::pair &lt;double,double&gt; r = boost::math::tools::bracket_and_solve_root(boostFunction, (this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a4f2084d334b69fb675f276f45180f485">GetLowerBound</a>() + this-&gt;<a class="code" href="classanima_1_1BaseRootFindingAlgorithm.html#a47b532a87a1dc12b6dd4dd9f5b622b13">GetUpperBound</a>()) / 2.0, 2.0, risingValue, rootTolerance, maximumNumberOfIterations);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    </div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">return</span> (r.first + r.second) / 2.0;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;} <span class="comment">// end namespace anima</span></div><div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a0961ac6d461a4f1b727a9885056b1437"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a0961ac6d461a4f1b727a9885056b1437">anima::BaseRootFindingAlgorithm::GetFunctionValueAtInitialLowerBound</a></div><div class="ttdeci">double GetFunctionValueAtInitialLowerBound()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00065">animaBaseRootFindingAlgorithm.h:65</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a4f2084d334b69fb675f276f45180f485"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a4f2084d334b69fb675f276f45180f485">anima::BaseRootFindingAlgorithm::GetLowerBound</a></div><div class="ttdeci">double GetLowerBound()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00067">animaBaseRootFindingAlgorithm.h:67</a></div></div>
<div class="ttc" id="classanima_1_1BracketAndSolveRootFindingAlgorithm_html_a86f6e705db20a7ffb61530c38abe44f9"><div class="ttname"><a href="classanima_1_1BracketAndSolveRootFindingAlgorithm.html#a86f6e705db20a7ffb61530c38abe44f9">anima::BracketAndSolveRootFindingAlgorithm::Optimize</a></div><div class="ttdeci">double Optimize() ITK_OVERRIDE</div><div class="ttdef"><b>Definition:</b> <a href="animaBracketAndSolveRootFindingAlgorithm_8cxx_source.html#l00007">animaBracketAndSolveRootFindingAlgorithm.cxx:7</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a202d9b7564d73321feeb09ca05d3ab1f"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a202d9b7564d73321feeb09ca05d3ab1f">anima::BaseRootFindingAlgorithm::GetProvidedFunctionValueAtInitialLowerBound</a></div><div class="ttdeci">bool GetProvidedFunctionValueAtInitialLowerBound()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00063">animaBaseRootFindingAlgorithm.h:63</a></div></div>
<div class="ttc" id="classanima_1_1RootFindingFunctionBoostBridge_html_aabbc879200ff87c68e34da99ede750bd"><div class="ttname"><a href="classanima_1_1RootFindingFunctionBoostBridge.html#aabbc879200ff87c68e34da99ede750bd">anima::RootFindingFunctionBoostBridge::SetRootFindingFunction</a></div><div class="ttdeci">void SetRootFindingFunction(BaseCostFunctionType *f)</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00035">animaBaseRootFindingAlgorithm.h:35</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a31d49752862ff0470e8e91f3d1bbbfb7"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a31d49752862ff0470e8e91f3d1bbbfb7">anima::BaseRootFindingAlgorithm::GetRootRelativeTolerance</a></div><div class="ttdeci">double GetRootRelativeTolerance()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00070">animaBaseRootFindingAlgorithm.h:70</a></div></div>
<div class="ttc" id="animaBracketAndSolveRootFindingAlgorithm_8h_html"><div class="ttname"><a href="animaBracketAndSolveRootFindingAlgorithm_8h.html">animaBracketAndSolveRootFindingAlgorithm.h</a></div></div>
<div class="ttc" id="classanima_1_1RootToleranceBoostBridge_html"><div class="ttname"><a href="classanima_1_1RootToleranceBoostBridge.html">anima::RootToleranceBoostBridge</a></div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00011">animaBaseRootFindingAlgorithm.h:11</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a47b532a87a1dc12b6dd4dd9f5b622b13"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a47b532a87a1dc12b6dd4dd9f5b622b13">anima::BaseRootFindingAlgorithm::GetUpperBound</a></div><div class="ttdeci">double GetUpperBound()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00068">animaBaseRootFindingAlgorithm.h:68</a></div></div>
<div class="ttc" id="classanima_1_1RootToleranceBoostBridge_html_a3c017a3e2f5570e117f0ecf2d9f99cdb"><div class="ttname"><a href="classanima_1_1RootToleranceBoostBridge.html#a3c017a3e2f5570e117f0ecf2d9f99cdb">anima::RootToleranceBoostBridge::SetRootRelativeTolerance</a></div><div class="ttdeci">void SetRootRelativeTolerance(const double &amp;tol)</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00019">animaBaseRootFindingAlgorithm.h:19</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_ad1cd8c9fbb8b9304e49f237a00f30088"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#ad1cd8c9fbb8b9304e49f237a00f30088">anima::BaseRootFindingAlgorithm::GetProvidedFunctionValueAtInitialUpperBound</a></div><div class="ttdeci">bool GetProvidedFunctionValueAtInitialUpperBound()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00064">animaBaseRootFindingAlgorithm.h:64</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a9ce5966e0d71ec6a1b278dc0de18bff9"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a9ce5966e0d71ec6a1b278dc0de18bff9">anima::BaseRootFindingAlgorithm::GetMaximumNumberOfIterations</a></div><div class="ttdeci">unsigned int GetMaximumNumberOfIterations()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00069">animaBaseRootFindingAlgorithm.h:69</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_a707553423a63cf4787b3714475f07c2f"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#a707553423a63cf4787b3714475f07c2f">anima::BaseRootFindingAlgorithm::GetFunctionValueAtInitialUpperBound</a></div><div class="ttdeci">double GetFunctionValueAtInitialUpperBound()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00066">animaBaseRootFindingAlgorithm.h:66</a></div></div>
<div class="ttc" id="namespaceanima_html"><div class="ttname"><a href="namespaceanima.html">anima</a></div><div class="ttdoc">Class performing lesion segmentation. </div><div class="ttdef"><b>Definition:</b> <a href="animaDTIEstimationImageFilter_8h_source.html#l00007">animaDTIEstimationImageFilter.h:7</a></div></div>
<div class="ttc" id="classanima_1_1BaseRootFindingAlgorithm_html_aa673fd745c3d10d230ea6202762c385d"><div class="ttname"><a href="classanima_1_1BaseRootFindingAlgorithm.html#aa673fd745c3d10d230ea6202762c385d">anima::BaseRootFindingAlgorithm::GetRootFindingFunction</a></div><div class="ttdeci">BaseCostFunctionType * GetRootFindingFunction()</div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00072">animaBaseRootFindingAlgorithm.h:72</a></div></div>
<div class="ttc" id="classanima_1_1RootFindingFunctionBoostBridge_html"><div class="ttname"><a href="classanima_1_1RootFindingFunctionBoostBridge.html">anima::RootFindingFunctionBoostBridge</a></div><div class="ttdef"><b>Definition:</b> <a href="animaBaseRootFindingAlgorithm_8h_source.html#l00026">animaBaseRootFindingAlgorithm.h:26</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-36582801-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
